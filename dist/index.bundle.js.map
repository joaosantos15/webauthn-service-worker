{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/script.js","webpack:///./src/webauthn/utils.js","webpack:///./src/webauthn/base64url-arraybuffer.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","document","getElementById","onclick","createElement","textContent","body","appendChild","username","alert","getMakeCredentialsChallenge","then","response","console","log","JSON","stringify","publicKey","utils","preformatMakeCredReq","navigator","credentials","makeCredResponse","publicKeyCredentialToJSON","sendWebAuthnResponse","catch","error","message","getGetAssertionChallenge","preformatGetAssertReq","getAssertionResponse","status","fetch","method","headers","Content-Type","json","Error","formBody","chars","lookup","Uint8Array","length","charCodeAt","decode","base64string","encoded1","encoded2","encoded3","encoded4","bufferLength","len","bytes","buffer","pubKeyCred","Array","arr","push","ArrayBuffer","arraybuffer","base64url","substring","encode","obj","generateRandomBuffer","randomBuffer","window","crypto","getRandomValues","makeCredReq","challenge","user","id","getAssert","allowCred","allowCredentials","__WEBPACK_AMD_DEFINE_RESULT__","methods","undefined","apply"],"mappings":"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","file":"index.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 83);\n","document.getElementById('clickMe').onclick = handleWebAuthn\ndocument.getElementById('loginbutton').onclick = handleLogin\nconst utils = require('./webauthn/utils')\nconsole.log('NONce: ' + 26)\n\nlet username\n\nlet sendWebAuthnResponse = (body) => {\n  return fetch('/webauthn/response', {\n    method: 'POST',\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(body)\n  })\n    .then((response) => response.json())\n    .then((response) => {\n      if (response.status !== 'ok') { throw new Error(`Server responed with error. The message is: ${response.message}`) }\n\n      return response\n    })\n}\n\nlet getMakeCredentialsChallenge = (formBody) => {\n  return fetch('/webauthn/register', {\n    method: 'POST',\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(formBody)\n  })\n.then((response) => response.json())\n.then((response) => {\n  console.log('Server response ' + JSON.stringify(response))\n\n  if (response.status !== 'ok') { throw new Error(`Server responed with error. The message is: ${response.message}`) }\n\n  return response.body\n}).catch(error => {\n  console.error(error)\n})\n}\n\nlet getGetAssertionChallenge = ({username}) => {\n  return fetch('/webauthn/login', {\n    method: 'POST',\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({username})\n  })\n    .then((response) => response.json())\n    .then((response) => {\n      if (response.status !== 'ok') { throw new Error(`Server responed with error. The message is: ${response.message}`) }\n\n      return response\n    })\n}\n\nfunction handleWebAuthn () {\n  var p = document.createElement('p')\n  p.textContent = 'This content was added via JavaScript!'\n  document.body.appendChild(p)\n\n  username = 'joaousername'\n  let name = 'joao'\n\n  if (!username || !name) {\n    alert('Name or username is missing!')\n  }\n\n  getMakeCredentialsChallenge({username, name}).then(\n           (response) => {\n             console.log('SW response: ' + JSON.stringify(response))\n\n             let publicKey = utils.preformatMakeCredReq(response)\n             console.log('PUBLIC KEY: ' + JSON.stringify(publicKey))\n             console.log('Creating credential...')\n             return navigator.credentials.create({publicKey})\n           }).then(response => {\n             console.log('Public key credential created')\n             let makeCredResponse = utils.publicKeyCredentialToJSON(response)\n             console.log('Adding username: ' + username)\n             makeCredResponse.username = username\n             console.log('Generating credentials json')\n             console.log(makeCredResponse)\n             return sendWebAuthnResponse(makeCredResponse)\n           }).then(console.log).catch((error) => console.error(error.message))\n}\n\nfunction handleLogin () {\n  // let username = this.username.value\n\n  if (!username) {\n    alert('Username is missing!')\n    return\n  }\n\n  getGetAssertionChallenge({username})\n        .then((response) => {\n          console.log('Login 1st response')\n          console.log(response)\n          let publicKey = utils.preformatGetAssertReq(response)\n        //   publicKey.rp = {}\n        //   publicKey.rp.id = 'localhost'\n\n          console.log('Login public key')\n          console.log(publicKey)\n\n          return navigator.credentials.get({ publicKey })\n        })\n        .then((response) => {\n          console.log('Loaded credential...')\n          console.log(response)\n          let getAssertionResponse = utils.publicKeyCredentialToJSON(response)\n          getAssertionResponse.username = username\n          console.log('getAssertionResponse')\n          console.log(getAssertionResponse)\n          return sendWebAuthnResponse(getAssertionResponse)\n        })\n        .then((response) => {\n          if (response.status === 'ok') {\n            alert('You are LOGGED IN!! ðŸš€ðŸš€')\n          } else {\n            alert(`Server responed with error. The message is: ${response.message}`)\n          }\n        })\n        .catch((error) => alert(error))\n}\n\nfunction handleTestClick () {\n  return fetch('/webauthn/test', {\n    method: 'POST',\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({username: username})\n  }).then(res => {\n    console.log('RESPONSE: 2')\n    console.log(res)\n    console.log(res.json())\n  })\n}\n","/**\n * Converts PublicKeyCredential into serialised JSON\n * @param  {Object} pubKeyCred\n * @return {Object}            - JSON encoded publicKeyCredential\n */\n\nconst base64 = require('./base64url-arraybuffer')\n\nlet chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'\n\n    // Use a lookup table to find the index.\nlet lookup = new Uint8Array(256)\nfor (let i = 0; i < chars.length; i++) {\n  lookup[chars.charCodeAt(i)] = i\n}\n\nlet encode = function (arraybuffer) {\n  let bytes = new Uint8Array(arraybuffer),\n    i, len = bytes.length, base64url = ''\n\n  for (i = 0; i < len; i += 3) {\n    base64url += chars[bytes[i] >> 2]\n    base64url += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)]\n    base64url += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)]\n    base64url += chars[bytes[i + 2] & 63]\n  }\n\n  if ((len % 3) === 2) {\n    base64url = base64url.substring(0, base64url.length - 1)\n  } else if (len % 3 === 1) {\n    base64url = base64url.substring(0, base64url.length - 2)\n  }\n\n  return base64url\n}\n\nlet decode = function (base64string) {\n  let bufferLength = base64string.length * 0.75,\n    len = base64string.length, i, p = 0,\n    encoded1, encoded2, encoded3, encoded4\n\n  let bytes = new Uint8Array(bufferLength)\n\n  for (i = 0; i < len; i += 4) {\n    encoded1 = lookup[base64string.charCodeAt(i)]\n    encoded2 = lookup[base64string.charCodeAt(i + 1)]\n    encoded3 = lookup[base64string.charCodeAt(i + 2)]\n    encoded4 = lookup[base64string.charCodeAt(i + 3)]\n\n    bytes[p++] = (encoded1 << 2) | (encoded2 >> 4)\n    bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2)\n    bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63)\n  }\n\n  return bytes.buffer\n}\n\nconst publicKeyCredentialToJSON = (pubKeyCred) => {\n  if (pubKeyCred instanceof Array) {\n    let arr = []\n    for (let i of pubKeyCred) { arr.push(publicKeyCredentialToJSON(i)) }\n\n    return arr\n  }\n\n  if (pubKeyCred instanceof ArrayBuffer) {\n    return encode(pubKeyCred)\n  }\n\n  if (pubKeyCred instanceof Object) {\n    let obj = {}\n\n    for (let key in pubKeyCred) {\n      obj[key] = publicKeyCredentialToJSON(pubKeyCred[key])\n    }\n\n    return obj\n  }\n\n  return pubKeyCred\n}\n\n/**\n * Generate secure random buffer\n * @param  {Number} len - Length of the buffer (default 32 bytes)\n * @return {Uint8Array} - random string\n */\nconst generateRandomBuffer = (len) => {\n  len = len || 32\n\n  let randomBuffer = new Uint8Array(len)\n  window.crypto.getRandomValues(randomBuffer)\n\n  return randomBuffer\n}\n\n/**\n * Decodes arrayBuffer required fields.\n */\nconst preformatMakeCredReq = (makeCredReq) => {\n  makeCredReq.challenge = new Uint8Array(decode(makeCredReq.challenge))\n  makeCredReq.user.id = new Uint8Array(decode(makeCredReq.user.id))\n\n  console.log('RET: ')\n  console.log(makeCredReq)\n  return makeCredReq\n}\n\n/**\n * Decodes arrayBuffer required fields.\n */\nconst preformatGetAssertReq = (getAssert) => {\n  getAssert.challenge = decode(getAssert.challenge)\n\n  for (let allowCred of getAssert.allowCredentials) {\n    allowCred.id = decode(allowCred.id)\n  }\n\n  return getAssert\n}\n\nmodule.exports = {\n  publicKeyCredentialToJSON,\n  generateRandomBuffer,\n  preformatMakeCredReq,\n  preformatGetAssertReq\n}\n","/*\n * Base64URL-ArrayBuffer\n * https://github.com/herrjemand/Base64URL-ArrayBuffer\n *\n * Copyright (c) 2017 Yuriy Ackermann <ackermann.yuriy@gmail.com>\n * Copyright (c) 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n *\n */\n(function () {\n  'use strict'\n\n  let chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'\n\n    // Use a lookup table to find the index.\n  let lookup = new Uint8Array(256)\n  for (let i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i\n  }\n\n  let encode = function (arraybuffer) {\n    let bytes = new Uint8Array(arraybuffer),\n      i, len = bytes.length, base64url = ''\n\n    for (i = 0; i < len; i += 3) {\n      base64url += chars[bytes[i] >> 2]\n      base64url += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)]\n      base64url += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)]\n      base64url += chars[bytes[i + 2] & 63]\n    }\n\n    if ((len % 3) === 2) {\n      base64url = base64url.substring(0, base64url.length - 1)\n    } else if (len % 3 === 1) {\n      base64url = base64url.substring(0, base64url.length - 2)\n    }\n\n    return base64url\n  }\n\n  let decode = function (base64string) {\n    let bufferLength = base64string.length * 0.75,\n      len = base64string.length, i, p = 0,\n      encoded1, encoded2, encoded3, encoded4\n\n    let bytes = new Uint8Array(bufferLength)\n\n    for (i = 0; i < len; i += 4) {\n      encoded1 = lookup[base64string.charCodeAt(i)]\n      encoded2 = lookup[base64string.charCodeAt(i + 1)]\n      encoded3 = lookup[base64string.charCodeAt(i + 2)]\n      encoded4 = lookup[base64string.charCodeAt(i + 3)]\n\n      bytes[p++] = (encoded1 << 2) | (encoded2 >> 4)\n      bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2)\n      bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63)\n    }\n\n    return bytes.buffer\n  }\n\n  let methods = {\n    'decode': decode,\n    'encode': encode\n  }\n  window.base64url = methods\n\n    /**\n     * Exporting and stuff\n     */\n  if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {\n    module.exports = methods\n  } else {\n    if (typeof define === 'function' && define.amd) {\n      define([], function () {\n        return methods\n      })\n    } else {\n      window.base64url = methods\n    }\n  }\n})()\n"],"sourceRoot":""}
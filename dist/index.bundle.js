!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=83)}({83:function(e,n,t){document.getElementById("clickMe").onclick=function(){var e=document.createElement("p");e.textContent="This content was added via JavaScript!",document.body.appendChild(e);(o="joaousername")||alert("Name or username is missing!");s({username:o,name:"joao"}).then(e=>{console.log("SW response: "+JSON.stringify(e));let n=r.preformatMakeCredReq(e);return console.log("PUBLIC KEY: "+JSON.stringify(n)),console.log("Creating credential..."),navigator.credentials.create({publicKey:n})}).then(e=>{console.log("Public key credential created");let n=r.publicKeyCredentialToJSON(e);return console.log("Adding username: "+o),n.username=o,console.log("Generating credentials json"),console.log(n),l(n)}).then(console.log).catch(e=>console.error(e.message))},document.getElementById("loginbutton").onclick=function(){if(!o)return void alert("Username is missing!");i({username:o}).then(e=>{console.log("Login 1st response"),console.log(e);let n=r.preformatGetAssertReq(e);return console.log("Login public key"),console.log(n),navigator.credentials.get({publicKey:n})}).then(e=>{console.log("Loaded credential..."),console.log(e);let n=r.publicKeyCredentialToJSON(e);return n.username=o,console.log("getAssertionResponse"),console.log(n),l(n)}).then(e=>{"ok"===e.status?alert("You are LOGGED IN!! ðŸš€ðŸš€"):alert(`Server responed with error. The message is: ${e.message}`)}).catch(e=>alert(e))};const r=t(84);let o;console.log("NONce: 26");let l=e=>fetch("/webauthn/response",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{if("ok"!==e.status)throw new Error(`Server responed with error. The message is: ${e.message}`);return e}),s=e=>fetch("/webauthn/register",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{if(console.log("Server response "+JSON.stringify(e)),"ok"!==e.status)throw new Error(`Server responed with error. The message is: ${e.message}`);return e.body}).catch(e=>{console.error(e)}),i=({username:e})=>fetch("/webauthn/login",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e})}).then(e=>e.json()).then(e=>{if("ok"!==e.status)throw new Error(`Server responed with error. The message is: ${e.message}`);return e})},84:function(e,n,t){t(85);let r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",o=new Uint8Array(256);for(let e=0;e<r.length;e++)o[r.charCodeAt(e)]=e;let l=function(e){let n,t,r,l,s,i=.75*e.length,a=e.length,c=0,u=new Uint8Array(i);for(n=0;n<a;n+=4)t=o[e.charCodeAt(n)],r=o[e.charCodeAt(n+1)],l=o[e.charCodeAt(n+2)],s=o[e.charCodeAt(n+3)],u[c++]=t<<2|r>>4,u[c++]=(15&r)<<4|l>>2,u[c++]=(3&l)<<6|63&s;return u.buffer};const s=e=>{if(e instanceof Array){let n=[];for(let t of e)n.push(s(t));return n}if(e instanceof ArrayBuffer)return function(e){let n,t=new Uint8Array(e),o=t.length,l="";for(n=0;n<o;n+=3)l+=r[t[n]>>2],l+=r[(3&t[n])<<4|t[n+1]>>4],l+=r[(15&t[n+1])<<2|t[n+2]>>6],l+=r[63&t[n+2]];return o%3==2?l=l.substring(0,l.length-1):o%3==1&&(l=l.substring(0,l.length-2)),l}(e);if(e instanceof Object){let n={};for(let t in e)n[t]=s(e[t]);return n}return e};e.exports={publicKeyCredentialToJSON:s,generateRandomBuffer:e=>{e=e||32;let n=new Uint8Array(e);return window.crypto.getRandomValues(n),n},preformatMakeCredReq:e=>(e.challenge=new Uint8Array(l(e.challenge)),e.user.id=new Uint8Array(l(e.user.id)),console.log("RET: "),console.log(e),e),preformatGetAssertReq:e=>{e.challenge=l(e.challenge);for(let n of e.allowCredentials)n.id=l(n.id);return e}}},85:function(e,n,t){var r;!function(){"use strict";let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",o=new Uint8Array(256);for(let e=0;e<t.length;e++)o[t.charCodeAt(e)]=e;let l={decode:function(e){let n,t,r,l,s,i=.75*e.length,a=e.length,c=0,u=new Uint8Array(i);for(n=0;n<a;n+=4)t=o[e.charCodeAt(n)],r=o[e.charCodeAt(n+1)],l=o[e.charCodeAt(n+2)],s=o[e.charCodeAt(n+3)],u[c++]=t<<2|r>>4,u[c++]=(15&r)<<4|l>>2,u[c++]=(3&l)<<6|63&s;return u.buffer},encode:function(e){let n,r=new Uint8Array(e),o=r.length,l="";for(n=0;n<o;n+=3)l+=t[r[n]>>2],l+=t[(3&r[n])<<4|r[n+1]>>4],l+=t[(15&r[n+1])<<2|r[n+2]>>6],l+=t[63&r[n+2]];return o%3==2?l=l.substring(0,l.length-1):o%3==1&&(l=l.substring(0,l.length-2)),l}};window.base64url=l,void 0!==e.exports?e.exports=l:void 0===(r=function(){return l}.apply(n,[]))||(e.exports=r)}()}});
//# sourceMappingURL=index.bundle.js.map
{"map":"{\"version\":3,\"sources\":[\"webpack/bootstrap\",\"/Users/boss/git/playground/service-worker-bundle/src/script.js\",\"/Users/boss/git/playground/service-worker-bundle/src/webauthn/utils.js\",\"/Users/boss/git/playground/service-worker-bundle/src/webauthn/base64url-arraybuffer.js\"],\"names\":[\"installedModules\",\"__webpack_require__\",\"moduleId\",\"exports\",\"module\",\"i\",\"l\",\"modules\",\"call\",\"m\",\"c\",\"d\",\"name\",\"getter\",\"o\",\"Object\",\"defineProperty\",\"enumerable\",\"get\",\"r\",\"Symbol\",\"toStringTag\",\"value\",\"t\",\"mode\",\"__esModule\",\"ns\",\"create\",\"key\",\"bind\",\"n\",\"object\",\"property\",\"prototype\",\"hasOwnProperty\",\"p\",\"s\",\"document\",\"getElementById\",\"onclick\",\"createElement\",\"textContent\",\"body\",\"appendChild\",\"getMakeCredentialsChallenge\",\"username\",\"then\",\"response\",\"console\",\"log\",\"JSON\",\"stringify\",\"publicKey\",\"utils\",\"preformatMakeCredReq\",\"navigator\",\"credentials\",\"makeCredResponse\",\"publicKeyCredentialToJSON\",\"sendWebAuthnResponse\",\"catch\",\"error\",\"message\",\"fetch\",\"method\",\"headers\",\"Content-Type\",\"formBody\",\"res\",\"json\",\"status\",\"Error\",\"chars\",\"lookup\",\"Uint8Array\",\"length\",\"charCodeAt\",\"decode\",\"base64string\",\"encoded1\",\"encoded2\",\"encoded3\",\"encoded4\",\"bufferLength\",\"len\",\"bytes\",\"buffer\",\"pubKeyCred\",\"Array\",\"arr\",\"push\",\"ArrayBuffer\",\"arraybuffer\",\"base64url\",\"substring\",\"encode\",\"obj\",\"generateRandomBuffer\",\"randomBuffer\",\"window\",\"crypto\",\"getRandomValues\",\"makeCredReq\",\"challenge\",\"user\",\"id\",\"preformatGetAssertReq\",\"getAssert\",\"allowCred\",\"allowCredentials\",\"__WEBPACK_AMD_DEFINE_RESULT__\",\"methods\",\"undefined\",\"apply\"],\"mappings\":\"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\",\"sourcesContent\":[\" \\t// The module cache\\n \\tvar installedModules = {};\\n\\n \\t// The require function\\n \\tfunction __webpack_require__(moduleId) {\\n\\n \\t\\t// Check if module is in cache\\n \\t\\tif(installedModules[moduleId]) {\\n \\t\\t\\treturn installedModules[moduleId].exports;\\n \\t\\t}\\n \\t\\t// Create a new module (and put it into the cache)\\n \\t\\tvar module = installedModules[moduleId] = {\\n \\t\\t\\ti: moduleId,\\n \\t\\t\\tl: false,\\n \\t\\t\\texports: {}\\n \\t\\t};\\n\\n \\t\\t// Execute the module function\\n \\t\\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\\n\\n \\t\\t// Flag the module as loaded\\n \\t\\tmodule.l = true;\\n\\n \\t\\t// Return the exports of the module\\n \\t\\treturn module.exports;\\n \\t}\\n\\n\\n \\t// expose the modules object (__webpack_modules__)\\n \\t__webpack_require__.m = modules;\\n\\n \\t// expose the module cache\\n \\t__webpack_require__.c = installedModules;\\n\\n \\t// define getter function for harmony exports\\n \\t__webpack_require__.d = function(exports, name, getter) {\\n \\t\\tif(!__webpack_require__.o(exports, name)) {\\n \\t\\t\\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\\n \\t\\t}\\n \\t};\\n\\n \\t// define __esModule on exports\\n \\t__webpack_require__.r = function(exports) {\\n \\t\\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\\n \\t\\t\\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\\n \\t\\t}\\n \\t\\tObject.defineProperty(exports, '__esModule', { value: true });\\n \\t};\\n\\n \\t// create a fake namespace object\\n \\t// mode & 1: value is a module id, require it\\n \\t// mode & 2: merge all properties of value into the ns\\n \\t// mode & 4: return value when already ns object\\n \\t// mode & 8|1: behave like require\\n \\t__webpack_require__.t = function(value, mode) {\\n \\t\\tif(mode & 1) value = __webpack_require__(value);\\n \\t\\tif(mode & 8) return value;\\n \\t\\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\\n \\t\\tvar ns = Object.create(null);\\n \\t\\t__webpack_require__.r(ns);\\n \\t\\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\\n \\t\\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\\n \\t\\treturn ns;\\n \\t};\\n\\n \\t// getDefaultExport function for compatibility with non-harmony modules\\n \\t__webpack_require__.n = function(module) {\\n \\t\\tvar getter = module && module.__esModule ?\\n \\t\\t\\tfunction getDefault() { return module['default']; } :\\n \\t\\t\\tfunction getModuleExports() { return module; };\\n \\t\\t__webpack_require__.d(getter, 'a', getter);\\n \\t\\treturn getter;\\n \\t};\\n\\n \\t// Object.prototype.hasOwnProperty.call\\n \\t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\\n\\n \\t// __webpack_public_path__\\n \\t__webpack_require__.p = \\\"\\\";\\n\\n\\n \\t// Load entry module and return exports\\n \\treturn __webpack_require__(__webpack_require__.s = 83);\\n\",\"document.getElementById('clickMe').onclick = handleWebAuthn\\ndocument.getElementById('clickMe2').onclick = handleTestClick\\nconst utils = require('./webauthn/utils')\\n\\nlet sendWebAuthnResponse = (body) => {\\n  return fetch('/webauthn/response', {\\n    method: 'POST',\\n    credentials: 'include',\\n    headers: {\\n      'Content-Type': 'application/json'\\n    },\\n    body: JSON.stringify(body)\\n  })\\n    .then((response) => response.json())\\n    .then((response) => {\\n      if (response.status !== 'ok') { throw new Error(`Server responed with error. The message is: ${response.message}`) }\\n\\n      return response\\n    })\\n}\\n\\nlet getMakeCredentialsChallenge = (formBody) => {\\n  return fetch('/webauthn/register', {\\n    method: 'POST',\\n    credentials: 'include',\\n    headers: {\\n      'Content-Type': 'application/json'\\n    },\\n    body: JSON.stringify(formBody)\\n  })\\n.then((response) => response.json())\\n.then((response) => {\\n  console.log('Server response ' + JSON.stringify(response))\\n\\n  if (response.status !== 'ok') { throw new Error(`Server responed with error. The message is: ${response.message}`) }\\n\\n  return response.body\\n}).catch(error => {\\n  console.error(error)\\n})\\n}\\n\\nfunction handleWebAuthn () {\\n  var p = document.createElement('p')\\n  p.textContent = 'This content was added via JavaScript!'\\n  document.body.appendChild(p)\\n\\n  let username = 'joaousername'\\n  let name = 'joao'\\n\\n  if (!username || !name) {\\n    alert('Name or username is missing!')\\n  }\\n\\n  getMakeCredentialsChallenge({username, name}).then(\\n           (response) => {\\n             console.log('SW response: ' + JSON.stringify(response))\\n\\n             let publicKey = utils.preformatMakeCredReq(response)\\n             console.log('PUBLIC KEY: ' + JSON.stringify(publicKey))\\n             console.log('Creating credential...')\\n             return navigator.credentials.create({publicKey})\\n           }).then(response => {\\n             console.log('Public key credential created')\\n             let makeCredResponse = utils.publicKeyCredentialToJSON(response)\\n             console.log('Generating credentials json')\\n             console.log(makeCredResponse)\\n             return sendWebAuthnResponse(makeCredResponse)\\n           }).then(console.log).catch((error) => console.error(error.message))\\n}\\n\\nfunction handleTestClick () {\\n  return fetch('/webauthn/test', {\\n    method: 'POST',\\n    credentials: 'include',\\n    headers: {\\n      'Content-Type': 'application/json'\\n    },\\n    body: JSON.stringify(formBody)\\n  }).then(res => {\\n    console.log('RESPONSE: ')\\n    console.log(res)\\n  })\\n}\\n\",\"/**\\n * Converts PublicKeyCredential into serialised JSON\\n * @param  {Object} pubKeyCred\\n * @return {Object}            - JSON encoded publicKeyCredential\\n */\\n\\nconst base64 = require('./base64url-arraybuffer')\\n\\nlet chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'\\n\\n    // Use a lookup table to find the index.\\nlet lookup = new Uint8Array(256)\\nfor (let i = 0; i < chars.length; i++) {\\n  lookup[chars.charCodeAt(i)] = i\\n}\\n\\nlet encode = function (arraybuffer) {\\n  let bytes = new Uint8Array(arraybuffer),\\n    i, len = bytes.length, base64url = ''\\n\\n  for (i = 0; i < len; i += 3) {\\n    base64url += chars[bytes[i] >> 2]\\n    base64url += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)]\\n    base64url += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)]\\n    base64url += chars[bytes[i + 2] & 63]\\n  }\\n\\n  if ((len % 3) === 2) {\\n    base64url = base64url.substring(0, base64url.length - 1)\\n  } else if (len % 3 === 1) {\\n    base64url = base64url.substring(0, base64url.length - 2)\\n  }\\n\\n  return base64url\\n}\\n\\nlet decode = function (base64string) {\\n  let bufferLength = base64string.length * 0.75,\\n    len = base64string.length, i, p = 0,\\n    encoded1, encoded2, encoded3, encoded4\\n\\n  let bytes = new Uint8Array(bufferLength)\\n\\n  for (i = 0; i < len; i += 4) {\\n    encoded1 = lookup[base64string.charCodeAt(i)]\\n    encoded2 = lookup[base64string.charCodeAt(i + 1)]\\n    encoded3 = lookup[base64string.charCodeAt(i + 2)]\\n    encoded4 = lookup[base64string.charCodeAt(i + 3)]\\n\\n    bytes[p++] = (encoded1 << 2) | (encoded2 >> 4)\\n    bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2)\\n    bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63)\\n  }\\n\\n  return bytes.buffer\\n}\\n\\nconst publicKeyCredentialToJSON = (pubKeyCred) => {\\n  if (pubKeyCred instanceof Array) {\\n    let arr = []\\n    for (let i of pubKeyCred) { arr.push(publicKeyCredentialToJSON(i)) }\\n\\n    return arr\\n  }\\n\\n  if (pubKeyCred instanceof ArrayBuffer) {\\n    return encode(pubKeyCred)\\n  }\\n\\n  if (pubKeyCred instanceof Object) {\\n    let obj = {}\\n\\n    for (let key in pubKeyCred) {\\n      obj[key] = publicKeyCredentialToJSON(pubKeyCred[key])\\n    }\\n\\n    return obj\\n  }\\n\\n  return pubKeyCred\\n}\\n\\n/**\\n * Generate secure random buffer\\n * @param  {Number} len - Length of the buffer (default 32 bytes)\\n * @return {Uint8Array} - random string\\n */\\nconst generateRandomBuffer = (len) => {\\n  len = len || 32\\n\\n  let randomBuffer = new Uint8Array(len)\\n  window.crypto.getRandomValues(randomBuffer)\\n\\n  return randomBuffer\\n}\\n\\n/**\\n * Decodes arrayBuffer required fields.\\n */\\nconst preformatMakeCredReq = (makeCredReq) => {\\n  makeCredReq.challenge = new Uint8Array(decode(makeCredReq.challenge))\\n  makeCredReq.user.id = new Uint8Array(decode(makeCredReq.user.id))\\n\\n  console.log('RET: ')\\n  console.log(makeCredReq)\\n  return makeCredReq\\n}\\n\\n/**\\n * Decodes arrayBuffer required fields.\\n */\\nconst preformatGetAssertReq = (getAssert) => {\\n  getAssert.challenge = decode(getAssert.challenge)\\n\\n  for (let allowCred of getAssert.allowCredentials) {\\n    allowCred.id = decode(allowCred.id)\\n  }\\n\\n  return getAssert\\n}\\n\\nmodule.exports = {\\n  publicKeyCredentialToJSON,\\n  generateRandomBuffer,\\n  preformatMakeCredReq,\\n  preformatGetAssertReq\\n}\\n\",\"/*\\n * Base64URL-ArrayBuffer\\n * https://github.com/herrjemand/Base64URL-ArrayBuffer\\n *\\n * Copyright (c) 2017 Yuriy Ackermann <ackermann.yuriy@gmail.com>\\n * Copyright (c) 2012 Niklas von Hertzen\\n * Licensed under the MIT license.\\n *\\n */\\n(function () {\\n  'use strict'\\n\\n  let chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'\\n\\n    // Use a lookup table to find the index.\\n  let lookup = new Uint8Array(256)\\n  for (let i = 0; i < chars.length; i++) {\\n    lookup[chars.charCodeAt(i)] = i\\n  }\\n\\n  let encode = function (arraybuffer) {\\n    let bytes = new Uint8Array(arraybuffer),\\n      i, len = bytes.length, base64url = ''\\n\\n    for (i = 0; i < len; i += 3) {\\n      base64url += chars[bytes[i] >> 2]\\n      base64url += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)]\\n      base64url += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)]\\n      base64url += chars[bytes[i + 2] & 63]\\n    }\\n\\n    if ((len % 3) === 2) {\\n      base64url = base64url.substring(0, base64url.length - 1)\\n    } else if (len % 3 === 1) {\\n      base64url = base64url.substring(0, base64url.length - 2)\\n    }\\n\\n    return base64url\\n  }\\n\\n  let decode = function (base64string) {\\n    let bufferLength = base64string.length * 0.75,\\n      len = base64string.length, i, p = 0,\\n      encoded1, encoded2, encoded3, encoded4\\n\\n    let bytes = new Uint8Array(bufferLength)\\n\\n    for (i = 0; i < len; i += 4) {\\n      encoded1 = lookup[base64string.charCodeAt(i)]\\n      encoded2 = lookup[base64string.charCodeAt(i + 1)]\\n      encoded3 = lookup[base64string.charCodeAt(i + 2)]\\n      encoded4 = lookup[base64string.charCodeAt(i + 3)]\\n\\n      bytes[p++] = (encoded1 << 2) | (encoded2 >> 4)\\n      bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2)\\n      bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63)\\n    }\\n\\n    return bytes.buffer\\n  }\\n\\n  let methods = {\\n    'decode': decode,\\n    'encode': encode\\n  }\\n  window.base64url = methods\\n\\n    /**\\n     * Exporting and stuff\\n     */\\n  if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {\\n    module.exports = methods\\n  } else {\\n    if (typeof define === 'function' && define.amd) {\\n      define([], function () {\\n        return methods\\n      })\\n    } else {\\n      window.base64url = methods\\n    }\\n  }\\n})()\\n\"]}","code":"!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=83)}({83:function(e,t,n){document.getElementById(\"clickMe\").onclick=function(){var e=document.createElement(\"p\");e.textContent=\"This content was added via JavaScript!\",document.body.appendChild(e);0;l({username:\"joaousername\",name:\"joao\"}).then(e=>{console.log(\"SW response: \"+JSON.stringify(e));let t=r.preformatMakeCredReq(e);return console.log(\"PUBLIC KEY: \"+JSON.stringify(t)),console.log(\"Creating credential...\"),navigator.credentials.create({publicKey:t})}).then(e=>{console.log(\"Public key credential created\");let t=r.publicKeyCredentialToJSON(e);return console.log(\"Generating credentials json\"),console.log(t),o(t)}).then(console.log).catch(e=>console.error(e.message))},document.getElementById(\"clickMe2\").onclick=function(){return fetch(\"/webauthn/test\",{method:\"POST\",credentials:\"include\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(formBody)}).then(e=>{console.log(\"RESPONSE: \"),console.log(e)})};const r=n(84);let o=e=>fetch(\"/webauthn/response\",{method:\"POST\",credentials:\"include\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{if(\"ok\"!==e.status)throw new Error(`Server responed with error. The message is: ${e.message}`);return e}),l=e=>fetch(\"/webauthn/register\",{method:\"POST\",credentials:\"include\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{if(console.log(\"Server response \"+JSON.stringify(e)),\"ok\"!==e.status)throw new Error(`Server responed with error. The message is: ${e.message}`);return e.body}).catch(e=>{console.error(e)})},84:function(e,t,n){n(85);let r=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\",o=new Uint8Array(256);for(let e=0;e<r.length;e++)o[r.charCodeAt(e)]=e;let l=function(e){let t,n,r,l,i,c=.75*e.length,a=e.length,s=0,u=new Uint8Array(c);for(t=0;t<a;t+=4)n=o[e.charCodeAt(t)],r=o[e.charCodeAt(t+1)],l=o[e.charCodeAt(t+2)],i=o[e.charCodeAt(t+3)],u[s++]=n<<2|r>>4,u[s++]=(15&r)<<4|l>>2,u[s++]=(3&l)<<6|63&i;return u.buffer};const i=e=>{if(e instanceof Array){let t=[];for(let n of e)t.push(i(n));return t}if(e instanceof ArrayBuffer)return function(e){let t,n=new Uint8Array(e),o=n.length,l=\"\";for(t=0;t<o;t+=3)l+=r[n[t]>>2],l+=r[(3&n[t])<<4|n[t+1]>>4],l+=r[(15&n[t+1])<<2|n[t+2]>>6],l+=r[63&n[t+2]];return o%3==2?l=l.substring(0,l.length-1):o%3==1&&(l=l.substring(0,l.length-2)),l}(e);if(e instanceof Object){let t={};for(let n in e)t[n]=i(e[n]);return t}return e};e.exports={publicKeyCredentialToJSON:i,generateRandomBuffer:e=>{e=e||32;let t=new Uint8Array(e);return window.crypto.getRandomValues(t),t},preformatMakeCredReq:e=>(e.challenge=new Uint8Array(l(e.challenge)),e.user.id=new Uint8Array(l(e.user.id)),console.log(\"RET: \"),console.log(e),e),preformatGetAssertReq:e=>{e.challenge=l(e.challenge);for(let t of e.allowCredentials)t.id=l(t.id);return e}}},85:function(e,t,n){var r;!function(){\"use strict\";let n=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\",o=new Uint8Array(256);for(let e=0;e<n.length;e++)o[n.charCodeAt(e)]=e;let l={decode:function(e){let t,n,r,l,i,c=.75*e.length,a=e.length,s=0,u=new Uint8Array(c);for(t=0;t<a;t+=4)n=o[e.charCodeAt(t)],r=o[e.charCodeAt(t+1)],l=o[e.charCodeAt(t+2)],i=o[e.charCodeAt(t+3)],u[s++]=n<<2|r>>4,u[s++]=(15&r)<<4|l>>2,u[s++]=(3&l)<<6|63&i;return u.buffer},encode:function(e){let t,r=new Uint8Array(e),o=r.length,l=\"\";for(t=0;t<o;t+=3)l+=n[r[t]>>2],l+=n[(3&r[t])<<4|r[t+1]>>4],l+=n[(15&r[t+1])<<2|r[t+2]>>6],l+=n[63&r[t+2]];return o%3==2?l=l.substring(0,l.length-1):o%3==1&&(l=l.substring(0,l.length-2)),l}};window.base64url=l,void 0!==e.exports?e.exports=l:void 0===(r=function(){return l}.apply(t,[]))||(e.exports=r)}()}});","extractedComments":[]}